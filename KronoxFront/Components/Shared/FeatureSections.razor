@using KronoxFront.ViewModels

@if (Sections.Count > 0)
{
    @foreach (var (featureItem, index) in Sections.Select((s, i) => (s, i)))
    {
        <div class="feature-section row align-items-center mb-5">
            @if (featureItem.HasImage)
            {
                <div class="col-md-4 mb-3 mb-md-0">
                    @if (!string.IsNullOrEmpty(featureItem.ImageUrl))
                    {
                        <img src="@featureItem.ImageUrl"
                            class="img-thumbnail feature-thumb w-100"
                            style="cursor:pointer"
                            alt="@(!string.IsNullOrEmpty(featureItem.ImageAltText) ? featureItem.ImageAltText : $"Bild för {featureItem.Title}")"
                            @onclick="() => OnImageClick.InvokeAsync(featureItem.ImageUrl)" />
                    }
                    else
                    {
                        <div class="bg-light p-4 text-center rounded">
                            <i class="fa-solid fa-image text-muted fa-3x"></i>
                        </div>
                    }
                </div>
                <div class="col-md-8">
                    @if (!string.IsNullOrWhiteSpace(featureItem.Title))
                    {
                        <h3 class="mb-4 fw-bold">@featureItem.Title</h3>
                    }
                    <div>@((MarkupString)featureItem.Content)</div>
                </div>
            }
            else
            {
                <div class="col-12 text-center">
                    @if (!string.IsNullOrWhiteSpace(featureItem.Title))
                    {
                        <h3 class="mb-4 fw-bold">@featureItem.Title</h3>
                    }
                    <div>@((MarkupString)featureItem.Content)</div>
                </div>
            }
        </div>

        @if (index < Sections.Count - 1)
        {
            <div class="divider"></div>
        }
    }
}
else
{
    <div class="text-center text-muted">
        <p>Innehållet laddas...</p>
        @if (IsAdmin)
        {
            <p><a href="@($"/admin/{PageKey}")" class="btn btn-primary">Lägg till innehåll</a></p>
        }
    </div>
}

@code {
    [Parameter] public List<FeatureSectionViewModel> Sections { get; set; } = new();
    [Parameter] public bool IsAdmin { get; set; } = false;
    [Parameter] public string PageKey { get; set; } = "";
    [Parameter] public EventCallback<string> OnImageClick { get; set; }
}